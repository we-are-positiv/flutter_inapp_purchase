"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[4454],{7294:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"getting-started/setup-android","title":"Android Setup","description":"This guide covers the complete setup process for implementing in-app purchases on Android.","source":"@site/docs/getting-started/setup-android.md","sourceDirName":"getting-started","slug":"/getting-started/setup-android","permalink":"/docs/getting-started/setup-android","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/docs/getting-started/setup-android.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3}}');var t=n(4848),r=n(8453);const l={sidebar_position:3},c="Android Setup",d={},a=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Configure Google Play Console",id:"step-1-configure-google-play-console",level:2},{value:"Create In-App Products",id:"create-in-app-products",level:3},{value:"Product Types",id:"product-types",level:3},{value:"Product Configuration",id:"product-configuration",level:3},{value:"Step 2: Configure Your App",id:"step-2-configure-your-app",level:2},{value:"Add Billing Permission",id:"add-billing-permission",level:3},{value:"Configure Build Settings",id:"configure-build-settings",level:3},{value:"Step 3: Upload Your App",id:"step-3-upload-your-app",level:2},{value:"Initial Release",id:"initial-release",level:3},{value:"Testing Tracks",id:"testing-tracks",level:3},{value:"Step 4: Set Up Test Accounts",id:"step-4-set-up-test-accounts",level:2},{value:"Add License Testers",id:"add-license-testers",level:3},{value:"Testing Best Practices",id:"testing-best-practices",level:3},{value:"Step 5: Testing In-App Purchases",id:"step-5-testing-in-app-purchases",level:2},{value:"Enable Test Purchases",id:"enable-test-purchases",level:3},{value:"Test Card Requirements",id:"test-card-requirements",level:3},{value:"Step 6: Handle Android-Specific Features",id:"step-6-handle-android-specific-features",level:2},{value:"Acknowledge Purchases",id:"acknowledge-purchases",level:3},{value:"Consume Purchases",id:"consume-purchases",level:3},{value:"Handle Pending Purchases",id:"handle-pending-purchases",level:3},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:2},{value:"Products Not Loading",id:"products-not-loading",level:3},{value:"Purchase Failures",id:"purchase-failures",level:3},{value:"Testing Issues",id:"testing-issues",level:3},{value:"Debugging Tips",id:"debugging-tips",level:2},{value:"Enable Debug Logging",id:"enable-debug-logging",level:3},{value:"Check Error Codes",id:"check-error-codes",level:3},{value:"Testing Checklist",id:"testing-checklist",level:2},{value:"Production Checklist",id:"production-checklist",level:2},{value:"Next Steps",id:"next-steps",level:2}];function o(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"android-setup",children:"Android Setup"})}),"\n",(0,t.jsx)(s.p,{children:"This guide covers the complete setup process for implementing in-app purchases on Android."}),"\n",(0,t.jsx)(s.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Google Play Developer account"}),"\n",(0,t.jsx)(s.li,{children:"Android Studio"}),"\n",(0,t.jsx)(s.li,{children:"Minimum Android SDK 21 (Android 5.0)"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-1-configure-google-play-console",children:"Step 1: Configure Google Play Console"}),"\n",(0,t.jsx)(s.h3,{id:"create-in-app-products",children:"Create In-App Products"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Log in to ",(0,t.jsx)(s.a,{href:"https://play.google.com/console",children:"Google Play Console"})]}),"\n",(0,t.jsx)(s.li,{children:"Select your application"}),"\n",(0,t.jsxs)(s.li,{children:["Navigate to ",(0,t.jsx)(s.strong,{children:"Monetize"})," \u2192 ",(0,t.jsx)(s.strong,{children:"In-app products"})]}),"\n",(0,t.jsxs)(s.li,{children:["Click ",(0,t.jsx)(s.strong,{children:"Create product"})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"product-types",children:"Product Types"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"One-time products"}),": Consumable or non-consumable items"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Subscriptions"}),": Recurring purchases"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"product-configuration",children:"Product Configuration"}),"\n",(0,t.jsx)(s.p,{children:"For each product:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Product ID"}),": Unique identifier (e.g., ",(0,t.jsx)(s.code,{children:"premium_upgrade"}),")"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Name"}),": Display name for users"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Description"}),": Product details"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Price"}),": Set pricing for each country/region"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Status"}),": Set to ",(0,t.jsx)(s.strong,{children:"Active"})]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-2-configure-your-app",children:"Step 2: Configure Your App"}),"\n",(0,t.jsx)(s.h3,{id:"add-billing-permission",children:"Add Billing Permission"}),"\n",(0,t.jsxs)(s.p,{children:["Add to your ",(0,t.jsx)(s.code,{children:"android/app/src/main/AndroidManifest.xml"}),":"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-xml",children:'<manifest xmlns:android="http://schemas.android.com/apk/res/android">\n    <uses-permission android:name="com.android.vending.BILLING" />\n    \n    <application\n        android:label="@string/app_name"\n        android:icon="@mipmap/ic_launcher">\n        \x3c!-- Your activities --\x3e\n    </application>\n</manifest>\n'})}),"\n",(0,t.jsx)(s.h3,{id:"configure-build-settings",children:"Configure Build Settings"}),"\n",(0,t.jsxs)(s.p,{children:["Ensure your ",(0,t.jsx)(s.code,{children:"android/app/build.gradle"})," has the correct configuration:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-gradle",children:'android {\n    compileSdkVersion 33\n    \n    defaultConfig {\n        applicationId "com.yourcompany.yourapp"\n        minSdkVersion 21\n        targetSdkVersion 33\n        versionCode 1\n        versionName "1.0"\n    }\n}\n'})}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Important"}),": The ",(0,t.jsx)(s.code,{children:"applicationId"})," must match exactly with Google Play Console."]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-3-upload-your-app",children:"Step 3: Upload Your App"}),"\n",(0,t.jsx)(s.h3,{id:"initial-release",children:"Initial Release"}),"\n",(0,t.jsx)(s.p,{children:"Products won't be available until your app is uploaded:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsx)(s.li,{children:"Build a signed APK or App Bundle"}),"\n",(0,t.jsxs)(s.li,{children:["Upload to ",(0,t.jsx)(s.strong,{children:"Internal Testing"}),", ",(0,t.jsx)(s.strong,{children:"Closed Testing"}),", or ",(0,t.jsx)(s.strong,{children:"Production"})]}),"\n",(0,t.jsx)(s.li,{children:"Complete store listing information"}),"\n",(0,t.jsx)(s.li,{children:"Submit for review (for production)"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"testing-tracks",children:"Testing Tracks"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Internal Testing"}),": Instant availability, up to 100 testers"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Closed Testing"}),": Requires review, unlimited testers"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Open Testing"}),": Public beta"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Production"}),": Full release"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-4-set-up-test-accounts",children:"Step 4: Set Up Test Accounts"}),"\n",(0,t.jsx)(s.h3,{id:"add-license-testers",children:"Add License Testers"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["In Google Play Console, go to ",(0,t.jsx)(s.strong,{children:"Setup"})," \u2192 ",(0,t.jsx)(s.strong,{children:"License testing"})]}),"\n",(0,t.jsx)(s.li,{children:"Add tester email addresses"}),"\n",(0,t.jsxs)(s.li,{children:["Set ",(0,t.jsx)(s.strong,{children:"License response"}),' to "RESPOND_NORMALLY"']}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"testing-best-practices",children:"Testing Best Practices"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Use Google accounts added as license testers"}),"\n",(0,t.jsx)(s.li,{children:"Test accounts need to accept testing invitation"}),"\n",(0,t.jsx)(s.li,{children:"Clear Google Play Store cache between tests"}),"\n",(0,t.jsx)(s.li,{children:"Test on real devices (not emulators)"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-5-testing-in-app-purchases",children:"Step 5: Testing In-App Purchases"}),"\n",(0,t.jsx)(s.h3,{id:"enable-test-purchases",children:"Enable Test Purchases"}),"\n",(0,t.jsx)(s.p,{children:"License testers can make test purchases without charges:"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:["Products show with ",(0,t.jsx)(s.strong,{children:"(Test)"})," suffix"]}),"\n",(0,t.jsx)(s.li,{children:"No actual charges are made"}),"\n",(0,t.jsx)(s.li,{children:"Test purchases auto-refund after 14 days"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"test-card-requirements",children:"Test Card Requirements"}),"\n",(0,t.jsx)(s.p,{children:"For testing subscriptions with test cards:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"The device must have a valid payment method"}),"\n",(0,t.jsx)(s.li,{children:"Test cards are only for license testers"}),"\n",(0,t.jsx)(s.li,{children:"Real charges won't occur"}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"step-6-handle-android-specific-features",children:"Step 6: Handle Android-Specific Features"}),"\n",(0,t.jsx)(s.h3,{id:"acknowledge-purchases",children:"Acknowledge Purchases"}),"\n",(0,t.jsx)(s.p,{children:"Android requires acknowledging purchases within 3 days:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"// Acknowledge a purchase\nawait FlutterInappPurchase.instance.acknowledgePurchase(\n  purchaseToken: purchase.purchaseToken!,\n);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"consume-purchases",children:"Consume Purchases"}),"\n",(0,t.jsx)(s.p,{children:"For consumable products:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"// Consume a purchase\nawait FlutterInappPurchase.instance.consumePurchase(\n  purchaseToken: purchase.purchaseToken!,\n);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"handle-pending-purchases",children:"Handle Pending Purchases"}),"\n",(0,t.jsx)(s.p,{children:"Some payment methods create pending purchases:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"// Check purchase state\nif (purchase.purchaseStateAndroid == PurchaseState.pending) {\n  // Handle pending purchase\n  showPendingUI();\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,t.jsx)(s.h3,{id:"products-not-loading",children:"Products Not Loading"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Check Product Status"}),': Must be "Active" in Play Console']}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"App Not Published"}),": Upload to at least Internal Testing"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Package Name Mismatch"}),": Verify applicationId matches"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Cache Issues"}),": Clear Play Store cache and data"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Wait Time"}),": Products may take 24+ hours to propagate"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"purchase-failures",children:"Purchase Failures"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Not Signed In"}),": Ensure Google account is signed in"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Country Restrictions"}),": Check product availability by country"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Payment Method"}),": Add valid payment method to account"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Version Code"}),": Uploaded APK version must be >= installed version"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"testing-issues",children:"Testing Issues"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Not a Tester"}),": Add account to license testers"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Wrong Account"}),": Ensure testing with correct Google account"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Emulator Issues"}),": Use real devices for testing"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Network Issues"}),": Check internet connectivity"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"debugging-tips",children:"Debugging Tips"}),"\n",(0,t.jsx)(s.h3,{id:"enable-debug-logging",children:"Enable Debug Logging"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"// Enable debug mode\nFlutterInappPurchase.instance.setDebugMode(true);\n"})}),"\n",(0,t.jsx)(s.h3,{id:"check-error-codes",children:"Check Error Codes"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-dart",children:"try {\n  await FlutterInappPurchase.instance.requestPurchase(productId);\n} catch (e) {\n  if (e.code == 'E_USER_CANCELLED') {\n    // User cancelled the purchase\n  } else if (e.code == 'E_ITEM_UNAVAILABLE') {\n    // Product not available\n  }\n  // Handle other errors\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"testing-checklist",children:"Testing Checklist"}),"\n",(0,t.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Products created and active in Play Console"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","BILLING permission added to manifest"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","App uploaded to testing track"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","License testers configured"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test on real device with test account"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test purchase flow"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test acknowledgment/consumption"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test restore purchases"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test error scenarios"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test pending purchases"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"production-checklist",children:"Production Checklist"}),"\n",(0,t.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Remove debug logging"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Implement server-side receipt validation"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Handle all error cases"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Test with production builds"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Monitor crash reports"]}),"\n",(0,t.jsxs)(s.li,{className:"task-list-item",children:[(0,t.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Set up purchase analytics"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"./setup-ios",children:"Learn about iOS setup"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"./quickstart",children:"Explore getting started guide"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"../api/error-codes",children:"Understand error codes"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var i=n(6540);const t={},r=i.createContext(t);function l(e){const s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);