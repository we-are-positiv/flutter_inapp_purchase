"use strict";(self.webpackChunkflutter_inapp_purchase_docs=self.webpackChunkflutter_inapp_purchase_docs||[]).push([[7265],{177:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"getting-started/setup-android","title":"Android Setup","description":"This guide covers the complete setup process for implementing in-app purchases on Android.","source":"@site/versioned_docs/version-6.3/getting-started/setup-android.md","sourceDirName":"getting-started","slug":"/getting-started/setup-android","permalink":"/docs/6.3/getting-started/setup-android","draft":false,"unlisted":false,"editUrl":"https://github.com/hyochan/flutter_inapp_purchase/tree/main/docs/versioned_docs/version-6.3/getting-started/setup-android.md","tags":[],"version":"6.3","sidebarPosition":3,"frontMatter":{"sidebar_position":3}}');var r=s(4848),t=s(8453);const d={sidebar_position:3},l="Android Setup",c={},o=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Configure Google Play Console",id:"step-1-configure-google-play-console",level:2},{value:"Create In-App Products",id:"create-in-app-products",level:3},{value:"Product Types",id:"product-types",level:3},{value:"Product Configuration",id:"product-configuration",level:3},{value:"Step 2: Configure Your App",id:"step-2-configure-your-app",level:2},{value:"Add Billing Permission",id:"add-billing-permission",level:3},{value:"Configure Build Settings",id:"configure-build-settings",level:3},{value:"Step 3: Upload Your App",id:"step-3-upload-your-app",level:2},{value:"Initial Release",id:"initial-release",level:3},{value:"Testing Tracks",id:"testing-tracks",level:3},{value:"Step 4: Set Up Test Accounts",id:"step-4-set-up-test-accounts",level:2},{value:"Add License Testers",id:"add-license-testers",level:3},{value:"Testing Best Practices",id:"testing-best-practices",level:3},{value:"Step 5: Testing In-App Purchases",id:"step-5-testing-in-app-purchases",level:2},{value:"Enable Test Purchases",id:"enable-test-purchases",level:3},{value:"Test Card Requirements",id:"test-card-requirements",level:3},{value:"Step 6: Handle Android-Specific Features",id:"step-6-handle-android-specific-features",level:2},{value:"Acknowledge Purchases",id:"acknowledge-purchases",level:3},{value:"Consume Purchases",id:"consume-purchases",level:3},{value:"Common Issues and Solutions",id:"common-issues-and-solutions",level:2},{value:"Products Not Loading",id:"products-not-loading",level:3},{value:"Purchase Failures",id:"purchase-failures",level:3},{value:"Testing Issues",id:"testing-issues",level:3},{value:"Debugging Tips",id:"debugging-tips",level:2},{value:"Enable Debug Logging",id:"enable-debug-logging",level:3},{value:"Check Error Codes",id:"check-error-codes",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"android-setup",children:"Android Setup"})}),"\n",(0,r.jsx)(n.p,{children:"This guide covers the complete setup process for implementing in-app purchases on Android."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Google Play Developer account"}),"\n",(0,r.jsx)(n.li,{children:"Android Studio"}),"\n",(0,r.jsx)(n.li,{children:"Minimum Android SDK 21 (Android 5.0)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-1-configure-google-play-console",children:"Step 1: Configure Google Play Console"}),"\n",(0,r.jsx)(n.h3,{id:"create-in-app-products",children:"Create In-App Products"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Log in to ",(0,r.jsx)(n.a,{href:"https://play.google.com/console",children:"Google Play Console"})]}),"\n",(0,r.jsx)(n.li,{children:"Select your application"}),"\n",(0,r.jsxs)(n.li,{children:["Navigate to ",(0,r.jsx)(n.strong,{children:"Monetize"})," \u2192 ",(0,r.jsx)(n.strong,{children:"In-app products"})]}),"\n",(0,r.jsxs)(n.li,{children:["Click ",(0,r.jsx)(n.strong,{children:"Create product"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"product-types",children:"Product Types"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"One-time products"}),": Consumable or non-consumable items"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscriptions"}),": Recurring purchases"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"product-configuration",children:"Product Configuration"}),"\n",(0,r.jsx)(n.p,{children:"For each product:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Product ID"}),": Unique identifier (e.g., ",(0,r.jsx)(n.code,{children:"premium_upgrade"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name"}),": Display name for users"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description"}),": Product details"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Price"}),": Set pricing for each country/region"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Status"}),": Set to ",(0,r.jsx)(n.strong,{children:"Active"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-2-configure-your-app",children:"Step 2: Configure Your App"}),"\n",(0,r.jsx)(n.h3,{id:"add-billing-permission",children:"Add Billing Permission"}),"\n",(0,r.jsxs)(n.p,{children:["Add to your ",(0,r.jsx)(n.code,{children:"android/app/src/main/AndroidManifest.xml"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<manifest xmlns:android="http://schemas.android.com/apk/res/android">\n    <uses-permission android:name="com.android.vending.BILLING" />\n    \n    <application\n        android:label="@string/app_name"\n        android:icon="@mipmap/ic_launcher">\n        \x3c!-- Your activities --\x3e\n    </application>\n</manifest>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"configure-build-settings",children:"Configure Build Settings"}),"\n",(0,r.jsxs)(n.p,{children:["Ensure your ",(0,r.jsx)(n.code,{children:"android/app/build.gradle"})," has the correct configuration:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-gradle",children:'android {\n    compileSdkVersion 33\n    \n    defaultConfig {\n        applicationId "com.yourcompany.yourapp"\n        minSdkVersion 21\n        targetSdkVersion 33\n        versionCode 1\n        versionName "1.0"\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Important"}),": The ",(0,r.jsx)(n.code,{children:"applicationId"})," must match exactly with Google Play Console."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-3-upload-your-app",children:"Step 3: Upload Your App"}),"\n",(0,r.jsx)(n.h3,{id:"initial-release",children:"Initial Release"}),"\n",(0,r.jsx)(n.p,{children:"Products won't be available until your app is uploaded:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Build a signed APK or App Bundle"}),"\n",(0,r.jsxs)(n.li,{children:["Upload to ",(0,r.jsx)(n.strong,{children:"Internal Testing"}),", ",(0,r.jsx)(n.strong,{children:"Closed Testing"}),", or ",(0,r.jsx)(n.strong,{children:"Production"})]}),"\n",(0,r.jsx)(n.li,{children:"Complete store listing information"}),"\n",(0,r.jsx)(n.li,{children:"Submit for review (for production)"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"testing-tracks",children:"Testing Tracks"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Internal Testing"}),": Instant availability, up to 100 testers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Closed Testing"}),": Requires review, unlimited testers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Open Testing"}),": Public beta"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Production"}),": Full release"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-4-set-up-test-accounts",children:"Step 4: Set Up Test Accounts"}),"\n",(0,r.jsx)(n.h3,{id:"add-license-testers",children:"Add License Testers"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["In Google Play Console, go to ",(0,r.jsx)(n.strong,{children:"Setup"})," \u2192 ",(0,r.jsx)(n.strong,{children:"License testing"})]}),"\n",(0,r.jsx)(n.li,{children:"Add tester email addresses"}),"\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.strong,{children:"License response"}),' to "RESPOND_NORMALLY"']}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"testing-best-practices",children:"Testing Best Practices"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use Google accounts added as license testers"}),"\n",(0,r.jsx)(n.li,{children:"Test accounts need to accept testing invitation"}),"\n",(0,r.jsx)(n.li,{children:"Clear Google Play Store cache between tests"}),"\n",(0,r.jsx)(n.li,{children:"Test on real devices (not emulators)"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-5-testing-in-app-purchases",children:"Step 5: Testing In-App Purchases"}),"\n",(0,r.jsx)(n.h3,{id:"enable-test-purchases",children:"Enable Test Purchases"}),"\n",(0,r.jsx)(n.p,{children:"License testers can make test purchases without charges:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Products show with ",(0,r.jsx)(n.strong,{children:"(Test)"})," suffix"]}),"\n",(0,r.jsx)(n.li,{children:"No actual charges are made"}),"\n",(0,r.jsx)(n.li,{children:"Test purchases auto-refund after 14 days"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"test-card-requirements",children:"Test Card Requirements"}),"\n",(0,r.jsx)(n.p,{children:"For testing subscriptions with test cards:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The device must have a valid payment method"}),"\n",(0,r.jsx)(n.li,{children:"Test cards are only for license testers"}),"\n",(0,r.jsx)(n.li,{children:"Real charges won't occur"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"step-6-handle-android-specific-features",children:"Step 6: Handle Android-Specific Features"}),"\n",(0,r.jsx)(n.h3,{id:"acknowledge-purchases",children:"Acknowledge Purchases"}),"\n",(0,r.jsx)(n.p,{children:"Android requires acknowledging purchases within 3 days:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"// Acknowledge a purchase\nawait FlutterInappPurchase.instance.acknowledgePurchase(\n  purchaseToken: purchase.purchaseToken!,\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"consume-purchases",children:"Consume Purchases"}),"\n",(0,r.jsx)(n.p,{children:"For consumable products:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"// Consume a purchase on Android\nawait FlutterInappPurchase.instance.consumePurchaseAndroid(\n  purchaseToken: purchase.purchaseToken!,\n);\n\n### Handle Pending Purchases\n\nSome payment methods create pending purchases:\n\n```dart\n// Check purchase state\nif (purchase.purchaseStateAndroid == PurchaseState.pending) {\n  // Handle pending purchase\n  showPendingUI();\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-issues-and-solutions",children:"Common Issues and Solutions"}),"\n",(0,r.jsx)(n.h3,{id:"products-not-loading",children:"Products Not Loading"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check Product Status"}),': Must be "Active" in Play Console']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"App Not Published"}),": Upload to at least Internal Testing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Package Name Mismatch"}),": Verify applicationId matches"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cache Issues"}),": Clear Play Store cache and data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Wait Time"}),": Products may take 24+ hours to propagate"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"purchase-failures",children:"Purchase Failures"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Not Signed In"}),": Ensure Google account is signed in"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Country Restrictions"}),": Check product availability by country"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Payment Method"}),": Add valid payment method to account"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Version Code"}),": Uploaded APK version must be >= installed version"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"testing-issues",children:"Testing Issues"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Not a Tester"}),": Add account to license testers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Wrong Account"}),": Ensure testing with correct Google account"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Emulator Issues"}),": Use real devices for testing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network Issues"}),": Check internet connectivity"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"debugging-tips",children:"Debugging Tips"}),"\n",(0,r.jsx)(n.h3,{id:"enable-debug-logging",children:"Enable Debug Logging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"// Enable debug mode\nFlutterInappPurchase.instance.setDebugMode(true);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"check-error-codes",children:"Check Error Codes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"try {\n  await FlutterInappPurchase.instance.requestPurchase(\n    request: RequestPurchase(\n      android: RequestPurchaseAndroid(skus: [productId]),\n    ),\n    type: PurchaseType.inapp,\n  );\n} catch (e) {\n  if (e.code == 'E_USER_CANCELLED') {\n    // User cancelled the purchase\n  } else if (e.code == 'E_ITEM_UNAVAILABLE') {\n    // Product not available\n  }\n  // Handle other errors\n}\n\n## Testing Checklist\n\n- [ ] Products created and active in Play Console\n- [ ] BILLING permission added to manifest\n- [ ] App uploaded to testing track\n- [ ] License testers configured\n- [ ] Test on real device with test account\n- [ ] Test purchase flow\n- [ ] Test acknowledgment/consumption\n- [ ] Test restore purchases\n- [ ] Test error scenarios\n- [ ] Test pending purchases\n\n## Production Checklist\n\n- [ ] Remove debug logging\n      await FlutterInappPurchase.instance.requestPurchase(\n        request: RequestPurchase(\n          android: RequestPurchaseAndroid(skus: [product.productId!]),\n        ),\n        type: type,\n      );\n\n- [Learn about iOS setup](./setup-ios)\n- [Explore getting started guide](./quickstart)\n- [Understand error codes](../api/error-codes)\n"})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>l});var i=s(6540);const r={},t=i.createContext(r);function d(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);